{% extends "base.html" %}
{% load static%}
{% load crispy_forms_tags %}
{% block title%} Create Purchase Order {% endblock%}
{% block content %}
   <div class="inventory">
        <div class='add-production-plan'>
            <div class='production-plan mt-2  d-flex justify-content-between align-items-center'>
                <div>
                    <a href='{% url "inventory:production_plans"%}' class='border btn bx bx-arrow-back fs-5'></a>
                    <a href='/' class='bx bx-home btn border fs-5 mx-2'></a>
                    <span class='mt-2 fs-5'>Create Production Plan</span>
                </div>
                <div>
                    <ul class="list-unstyled mt-3">
                        <li>
                            <a href="{% url 'inventory:production_plans' %}" class="btn border">Production Plan</a>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="row">
                <div class="col-9">
                    <table class="table">
                        <thead class="bg-primary">
                            <th>Raw Material</th>
                            <th>Quantity</th>
                            <th>Unit Cost</th>
                            <th>Total Cost</th>
                            <th>RM B/F quantity</th>
                            <th>LF B/f quantity</th>
                            <th>Actual quantity</th>
                            <th>Timeout</th>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
                <div class="col-3">
                    <form action="" method="post">
                        {% csrf_token %}
                        {{ form.as_p }}
                        <button class="btn btn-secondary btn-sm w-100">Save</button>
                    </form>
                </div>
            </div>
        </div>
   </div>   
   <script>
    $(document).ready(function() {
        let data = []
        $('#id_product').select2();
        $('#id_dish').select2();
      
        $('#id_product').on('change', function(e) {
          const selectedProductId = e.target.value;
      
          const postData = {
            csrfmiddlewaretoken: $('input[name="csrfmiddlewaretoken"]').val(),
            raw_material: selectedProductId,
            //...otherData
          };
      
          fetch('{% url "inventory:yeseterdays_left_overs"%}', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
              'X-CSRFToken': $('input[name="csrfmiddlewaretoken"]').val()
            },
            body: JSON.stringify(postData)
          })
            .then(response => response.json())
            .then(data => {
              
              console.log(data);
            })
            .catch(error => {
              console.error('Error posting product data:', error);
            });
        });
      });
      
   </script>
{% endblock content %}